{% extends "base/base.html" %}
{% block title %}Project Analytics{% endblock %}
{% block content %}

<div class="mb-3">
    <a href="{% url 'project-list' %}"
       class="btn btn-outline-secondary">
        ‚Üê Back to Projects
    </a>
</div>

<h2 class="mb-4">Project Analytics</h2>

{% if snapshots %}

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="text-muted">Open</h6>
                <h3>{{ snapshots.0.tasks_open }}</h3>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="text-muted">In Progress</h6>
                <h3>{{ snapshots.0.tasks_in_progress }}</h3>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="text-muted">Blocked</h6>
                <h3>{{ snapshots.0.tasks_blocked }}</h3>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="text-muted">Done</h6>
                <h3>{{ snapshots.0.tasks_done }}</h3>
            </div>
        </div>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-bordered table-striped align-middle">
        <thead class="table-light">
        <tr>
            <th>Date</th>
            <th>Open</th>
            <th>In Progress</th>
            <th>Blocked</th>
            <th>Done</th>
            <th>Created</th>
            <th>Completed</th>
            <th>Avg Completion (sec)</th>
        </tr>
        </thead>
        <tbody>
        {% for s in snapshots %}
        <tr>
            <td>{{ s.date }}</td>
            <td>{{ s.tasks_open }}</td>
            <td>{{ s.tasks_in_progress }}</td>
            <td>{{ s.tasks_blocked }}</td>
            <td>{{ s.tasks_done }}</td>
            <td>{{ s.tasks_created }}</td>
            <td>{{ s.tasks_completed }}</td>
            <td>{{ s.avg_completion_seconds }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

{% else %}
<div class="alert alert-info">
    No analytics data available for this project yet.
</div>
{% endif %}

{% endblock %}
